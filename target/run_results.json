{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "2026.2.5+dde6c12", "generated_at": "2026-02-10T22:57:35.803077Z", "invocation_id": "c86066ee-c027-403e-8a54-1a304f39e530", "invocation_started_at": "2026-02-10T22:57:24.040123Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:26.905269Z", "completed_at": "2026-02-10T22:57:27.033462Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:27.035932Z", "completed_at": "2026-02-10T22:57:28.007473Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1198155879974365, "adapter_response": {"_message": "SUCCESS 3", "code": "SUCCESS", "rows_affected": 3, "query_id": "01c25421-080a-d1f4-0004-7d832e2803f6", "rows_inserted": 3, "rows_deleted": 0, "rows_updated": 0, "rows_duplicates": 0}, "message": "SUCCESS 3", "failures": null, "unique_id": "model.analytics.raw_orders", "compiled": true, "compiled_code": "\n\nselect\n    1 as order_id,\n    1 as customer_id,\n    'cancelled' as status,\n    cast('2018-01-01' as date) as order_date,\n    cast('2018-01-01' as date) as modified_at\n\nunion select\n    2 as order_id,\n    1 as customer_id,\n    'completed' as status,\n    cast('2018-01-02' as date) as order_date,\n    cast('2018-01-02' as date) as modified_at\n\n-- -- add a new record\nunion select\n    '3' as order_id,\n    '2' as customer_id,\n    'completed' as status,\n    cast('2018-01-03' as date) as order_date,\n    cast('2018-01-04' as date) as modified_at\n\n-- -- -- add a record that conflicts with a previous order_id\n-- union select\n--     '1' as order_id,\n--     '1' as customer_id,\n--     'completed' as status,\n--     cast('2018-01-01' as date) as order_date,\n--     cast('2018-01-04' as date) as modified_at", "relation_name": "flybuysdb.dbt_lbondkennedy.raw_orders", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:26.908921Z", "completed_at": "2026-02-10T22:57:27.041252Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:27.076336Z", "completed_at": "2026-02-10T22:57:28.108005Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 1.218672275543213, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25421-080a-d1f4-0004-7d832e2803fe"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.analytics.stg_tpch_line_items", "compiled": true, "compiled_code": "with source as (\n\n    select * from raw.tpch_sf001.lineitem\n\n),\n\nrenamed as (\n\n    select\n    \n        md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))\n                as order_item_key,\n        l_orderkey as order_key,\n        l_partkey as part_key,\n        l_suppkey as supplier_key,\n        l_linenumber as line_number,\n        l_quantity as quantity,\n        l_extendedprice as extended_price,\n        l_discount as discount_percentage,\n        l_tax as tax_rate,\n        \n        case \n            when l_returnflag in ('R') then 'returned'\n            when l_returnflag in ('A') then 'accepted'\n            else 'unknown'\n        end as return_flag, \n\n        case \n            when return_flag = 'accepted' then false\n            else true\n        end as is_return,\n\n        case l_linestatus \n            when 'P' then 'returned'\n            when 'F' then 'billed'\n            when 'O' then 'shipped'\n            else null\n        end as status_code,\n        \n        l_shipdate as ship_date,\n        l_commitdate as commit_date,\n        l_receiptdate as receipt_date,\n        l_shipinstruct as ship_instructions,\n        l_shipmode as ship_mode,\n        l_comment as comment\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "flybuysdb.dbt_lbondkennedy.stg_tpch_line_items", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:28.013126Z", "completed_at": "2026-02-10T22:57:28.015809Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:28.016197Z", "completed_at": "2026-02-10T22:57:28.351619Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.33941173553466797, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25421-080a-dc5b-0004-7d832e27c692"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.analytics.stg_tpch_part_suppliers", "compiled": true, "compiled_code": "with source as (\n\n    select * from raw.tpch_sf001.partsupp\n\n),\n\nrenamed as (\n\n    select\n    \n        md5(cast(coalesce(cast(ps_partkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ps_suppkey as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) \n                as part_supplier_key,\n        ps_partkey as part_key,\n        ps_suppkey as supplier_key,\n        ps_availqty as available_quantity,\n        ps_supplycost as cost,\n        ps_comment as comment\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "flybuysdb.dbt_lbondkennedy.stg_tpch_part_suppliers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:27.027291Z", "completed_at": "2026-02-10T22:57:27.075511Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:27.120041Z", "completed_at": "2026-02-10T22:57:28.410512Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 1.5200819969177246, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25421-080a-d3e8-0004-7d832e27e57e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.analytics.stg_tpch_nations", "compiled": true, "compiled_code": "with source as (\n\n    select * from raw.tpch_sf001.nation\n\n),\n\nrenamed as (\n\n    select\n    \n        n_nationkey as nation_key,\n        n_name as name,\n        n_regionkey as region_key,\n        n_comment as comment\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "flybuysdb.dbt_lbondkennedy.stg_tpch_nations", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:26.907106Z", "completed_at": "2026-02-10T22:57:27.053029Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:27.109194Z", "completed_at": "2026-02-10T22:57:28.468023Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 1.5795772075653076, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25421-080a-d978-0004-7d832e27a83a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.analytics.stg_tpch_customers", "compiled": true, "compiled_code": "with source as (\n\n    select * from raw.tpch_sf001.customer\n\n),final as (\n\n    select\n    \n        c_custkey as customer_key,\n        c_name as name,\n        c_address as address, \n        c_nationkey as nation_key,\n        c_phone as phone_number,\n        c_acctbal as account_balance,\n        c_mktsegment as market_segment,\n        c_comment as comment\n\n    from source\n\n)\n\nselect * from final", "relation_name": "flybuysdb.dbt_lbondkennedy.stg_tpch_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:27.030845Z", "completed_at": "2026-02-10T22:57:27.041578Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:27.081602Z", "completed_at": "2026-02-10T22:57:28.478379Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 1.5872547626495361, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25421-080a-d3e8-0004-7d832e27e582"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.analytics.stg_tpch_orders", "compiled": true, "compiled_code": "with source as (\n\n    select * from raw.tpch_sf001.orders\n\n),\n\nrename as (\n\n    select\n    \n        o_orderkey as order_key,\n        o_custkey as customer_key,\n        o_orderstatus as status_code,\n        o_totalprice as total_price,\n        o_orderdate as order_date,\n        o_orderpriority as priority_code,\n        o_clerk as clerk_name,\n        o_shippriority as ship_priority,\n        o_comment as comment\n\n    from source\n\n)\n\nselect * from rename", "relation_name": "flybuysdb.dbt_lbondkennedy.stg_tpch_orders", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:28.111217Z", "completed_at": "2026-02-10T22:57:28.113132Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:28.113505Z", "completed_at": "2026-02-10T22:57:28.480286Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.36980104446411133, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25421-080a-d781-0004-7d832e27b6da"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.analytics.stg_tpch_parts", "compiled": true, "compiled_code": "with source as (\n\n    select * from raw.tpch_sf001.part\n\n),\n\nrenamed as (\n\n    select\n    \n        p_partkey as part_key,\n        p_name as name,\n        p_mfgr as manufacturer,\n        p_brand as brand,\n        p_type as type,\n        p_size as size,\n        p_container as container,\n        p_retailprice as retail_price,\n        p_comment as comment\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "flybuysdb.dbt_lbondkennedy.stg_tpch_parts", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:28.356264Z", "completed_at": "2026-02-10T22:57:28.359155Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:28.359704Z", "completed_at": "2026-02-10T22:57:28.744464Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3892834186553955, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25421-080a-dc9d-0004-7d832e27d69e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.analytics.stg_tpch_regions", "compiled": true, "compiled_code": "with source as (\n\n    select * from raw.tpch_sf001.region\n\n),\n\nrenamed as (\n\n    select\n        r_regionkey as region_key,\n        r_name as name,\n        r_comment as comment\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "flybuysdb.dbt_lbondkennedy.stg_tpch_regions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:28.413492Z", "completed_at": "2026-02-10T22:57:28.415605Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:28.416059Z", "completed_at": "2026-02-10T22:57:28.771470Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.3586878776550293, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25421-080a-d781-0004-7d832e27b6de"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.analytics.stg_tpch_suppliers", "compiled": true, "compiled_code": "with source as (\n\n    select * from raw.tpch_sf001.supplier\n\n),\n\nrenamed as (\n\n    select\n    \n        s_suppkey as supplier_key,\n        s_name as supplier_name,\n        s_address as supplier_address,\n        s_nationkey as nation_key,\n        s_phone as phone_number,\n        s_acctbal as account_balance,\n        s_comment as comment\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "flybuysdb.dbt_lbondkennedy.stg_tpch_suppliers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:28.774265Z", "completed_at": "2026-02-10T22:57:28.777828Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:28.778280Z", "completed_at": "2026-02-10T22:57:29.260715Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.48719286918640137, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25421-080a-d978-0004-7d832e27a842"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.analytics.order_items", "compiled": true, "compiled_code": "with orders as (\n    \n    select * from flybuysdb.dbt_lbondkennedy.stg_tpch_orders\n\n),\n\nline_item as (\n\n    select * from flybuysdb.dbt_lbondkennedy.stg_tpch_line_items\n\n)\nselect \n\n    line_item.order_item_key,\n    orders.order_key,\n    orders.customer_key,\n    line_item.part_key,\n    line_item.supplier_key,\n    orders.order_date,\n    orders.status_code as order_status_code,\n    \n    \n    line_item.is_return,\n    \n    line_item.line_number,\n    line_item.status_code as order_item_status_code,\n    line_item.ship_date,\n    line_item.commit_date,\n    line_item.receipt_date,\n    line_item.ship_mode,\n    line_item.extended_price,\n    line_item.quantity,\n    \n    -- extended_price is actually the line item total,\n    -- so we back out the extended price per item\n    (line_item.extended_price/nullif(line_item.quantity, 0))::decimal(16,3) as base_price,\n    line_item.discount_percentage,\n    (base_price * (1 - line_item.discount_percentage))::decimal(16,3) as discounted_price,\n\n    line_item.extended_price as gross_item_sales_amount,\n    (line_item.extended_price * (1 - line_item.discount_percentage))::decimal(16,3) as discounted_item_sales_amount,\n    -- We model discounts as negative amounts\n    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16,3) as item_discount_amount,\n    line_item.tax_rate,\n    ((gross_item_sales_amount + item_discount_amount) * line_item.tax_rate)::decimal(16,3) as item_tax_amount,\n    (\n        gross_item_sales_amount + \n        item_discount_amount + \n        item_tax_amount\n    )::decimal(16,3) as net_item_sales_amount\n\nfrom\n    orders\ninner join line_item\n        on orders.order_key = line_item.order_key\norder by\n    orders.order_date", "relation_name": "flybuysdb.dbt_lbondkennedy.order_items", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:28.496977Z", "completed_at": "2026-02-10T22:57:28.501524Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:28.502013Z", "completed_at": "2026-02-10T22:57:29.435544Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.943749189376831, "adapter_response": {"_message": "SUCCESS 1000", "code": "SUCCESS", "rows_affected": 1000, "query_id": "01c25421-080a-d1f4-0004-7d832e280402", "rows_inserted": 1000, "rows_deleted": 0, "rows_updated": 0, "rows_duplicates": 0}, "message": "SUCCESS 1000", "failures": null, "unique_id": "model.analytics.customer_tier", "compiled": true, "compiled_code": "\n\nwith customer as (\n    select * from flybuysdb.dbt_lbondkennedy.stg_tpch_customers\n),\n\norders as (\n    select * from flybuysdb.dbt_lbondkennedy.stg_tpch_orders\n),\nfinal as (\n    select\n        customer.customer_key,\n        sum(orders.total_price) as lifetime_value,\n        case \n            when lifetime_value <= 200000 then 'tier1'\n            when lifetime_value > 2000000 then 'tier2'\n            when lifetime_value between 1000000 and 1999999 then 'tier3'\n            when lifetime_value between 0 and 999999 then 'tier4' \n        end as tier_name\n    from customer\n        inner join orders\n            on customer.customer_key = orders.customer_key\n    group by 1\n)\n\nselect * from final", "relation_name": "flybuysdb.dbt_lbondkennedy.customer_tier", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:28.493651Z", "completed_at": "2026-02-10T22:57:28.499220Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:28.499685Z", "completed_at": "2026-02-10T22:57:29.448836Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.957482099533081, "adapter_response": {"_message": "SUCCESS 1000", "code": "SUCCESS", "rows_affected": 1000, "query_id": "01c25421-080a-d978-0004-7d832e27a83e", "rows_inserted": 1000, "rows_deleted": 0, "rows_updated": 0, "rows_duplicates": 0}, "message": "SUCCESS 1000", "failures": null, "unique_id": "model.analytics.customer_flags", "compiled": true, "compiled_code": "\n\nwith customer as (\n\n    select * from flybuysdb.dbt_lbondkennedy.stg_tpch_customers\n\n),\n\n    orders as (\n\n    select * from flybuysdb.dbt_lbondkennedy.stg_tpch_orders\n\n),\n    \n    final as (\n\n    select\n    \n        customer.customer_key,\n        coalesce(sum(orders.total_price),0) as lifetime_value,\n        iff(lifetime_value > 3000000, 'Y', 'N') as is_high_value,\n        iff(lifetime_value between 1000000 and 2999999, 'Y', 'N') as is_mid_value,\n        iff(lifetime_value between 0 and 999999, 'Y','N') as is_low_value\n\n    from customer\n        inner join orders\n            on customer.customer_key = orders.customer_key\n    group by 1\n)\n\nselect * from final", "relation_name": "flybuysdb.dbt_lbondkennedy.customer_flags", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:28.747611Z", "completed_at": "2026-02-10T22:57:28.750127Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:28.750585Z", "completed_at": "2026-02-10T22:57:29.597265Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.8504478931427002, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25421-080a-dcaa-0004-7d832e279bd2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.analytics.dim_parts", "compiled": true, "compiled_code": "\n\nwith part as (\n\n    select * from flybuysdb.dbt_lbondkennedy.stg_tpch_parts\n\n),\n\nfinal as (\n    select \n        part_key,\n        manufacturer,\n        name,\n        brand,\n        type,\n        size,\n        container,\n        retail_price\n    from\n        part\n)\nselect *\nfrom final  \norder by part_key", "relation_name": "flybuysdb.dbt_lbondkennedy.dim_parts", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:29.438551Z", "completed_at": "2026-02-10T22:57:29.441231Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:29.441687Z", "completed_at": "2026-02-10T22:57:30.205954Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.7681469917297363, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25421-080a-d3e8-0004-7d832e27e58a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.analytics.part_suppliers", "compiled": true, "compiled_code": "with part as (\n    \n    select * from flybuysdb.dbt_lbondkennedy.stg_tpch_parts\n\n),\n\nsupplier as (\n\n    select * from flybuysdb.dbt_lbondkennedy.stg_tpch_suppliers\n\n),\n\npart_supplier as (\n\n    select * from flybuysdb.dbt_lbondkennedy.stg_tpch_part_suppliers\n\n),\n\nfinal as (\n    select \n\n    part_supplier.part_supplier_key,\n    part.part_key,\n    part.name as part_name,\n    part.manufacturer,\n    part.brand,\n    part.type as part_type,\n    part.size as part_size,\n    part.container,\n    part.retail_price,\n\n    supplier.supplier_key,\n    supplier.supplier_name,\n    supplier.supplier_address,\n    supplier.phone_number,\n    supplier.account_balance,\n    supplier.nation_key,\n\n    part_supplier.available_quantity,\n    part_supplier.cost\nfrom\n    part \ninner join \n    part_supplier\n        on part.part_key = part_supplier.part_key\ninner join\n    supplier\n        on part_supplier.supplier_key = supplier.supplier_key\norder by\n    part.part_key\n)\n\nselect * from final", "relation_name": "flybuysdb.dbt_lbondkennedy.part_suppliers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:29.263658Z", "completed_at": "2026-02-10T22:57:29.266059Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:29.266426Z", "completed_at": "2026-02-10T22:57:30.431607Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 1.1686608791351318, "adapter_response": {"_message": "SUCCESS 100", "code": "SUCCESS", "rows_affected": 100, "query_id": "01c25421-080a-d1f4-0004-7d832e280406", "rows_inserted": 100, "rows_deleted": 0, "rows_updated": 0, "rows_duplicates": 0}, "message": "SUCCESS 100", "failures": null, "unique_id": "model.analytics.dim_suppliers", "compiled": true, "compiled_code": "\n\nwith supplier as (\n\n    select * from flybuysdb.dbt_lbondkennedy.stg_tpch_suppliers\n\n),\nnation as (\n\n    select * from flybuysdb.dbt_lbondkennedy.stg_tpch_nations\n),\nregion as (\n\n    select * from flybuysdb.dbt_lbondkennedy.stg_tpch_regions\n\n),\nfinal as (\n\n    select \n        supplier.supplier_key,\n        supplier.supplier_name,\n        supplier.supplier_address,\n        nation.name as nation,\n        region.name as region,\n        supplier.phone_number,\n        supplier.account_balance\n    from\n        supplier\n    inner join nation\n            on supplier.nation_key = nation.nation_key\n    inner join region \n            on nation.region_key = region.region_key\n)\n\nselect * from final", "relation_name": "flybuysdb.dbt_lbondkennedy.dim_suppliers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:26.893379Z", "completed_at": "2026-02-10T22:57:27.034886Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:27.047790Z", "completed_at": "2026-02-10T22:57:30.709420Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.8242928981781006, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01c25421-080a-d3e8-0004-7d832e27e586"}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.analytics.materialization_incremental", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select * from raw.tpch_sf001.customer\n\n),\n\n\nrenamed as (\n\n    select\n        c_custkey as customer_key,\n        c_name as name,\n        c_address as address, \n        c_nationkey as nation_key,\n        c_phone as phone_number,\n        c_acctbal as account_balance,\n        c_mktsegment as market_segment,\n        c_comment as comment\n\n    from source\n\n)\n\nselect * from renamed\n\n\n  -- this filter will only be applied on an incremental run\n  where customer_key not in (select customer_key from flybuysdb.dbt_lbondkennedy.materialization_incremental )\n\n", "relation_name": "flybuysdb.dbt_lbondkennedy.materialization_incremental", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:29.451878Z", "completed_at": "2026-02-10T22:57:29.454640Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:29.455091Z", "completed_at": "2026-02-10T22:57:30.714253Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 1.263073205947876, "adapter_response": {"_message": "SUCCESS 15000", "code": "SUCCESS", "rows_affected": 15000, "query_id": "01c25421-080a-d1f4-0004-7d832e28040a", "rows_inserted": 15000, "rows_deleted": 0, "rows_updated": 0, "rows_duplicates": 0}, "message": "SUCCESS 15000", "failures": null, "unique_id": "model.analytics.fct_orders", "compiled": true, "compiled_code": "\n\nwith orders as (\n    \n    select * from flybuysdb.dbt_lbondkennedy.stg_tpch_orders \n\n),\norder_item as (\n    \n    select * from flybuysdb.dbt_lbondkennedy.order_items\n\n),\norder_item_summary as (\n\n    select \n        order_key,\n        sum(gross_item_sales_amount) as gross_item_sales_amount,\n        sum(item_discount_amount) as item_discount_amount,\n        sum(item_tax_amount) as item_tax_amount,\n        sum(net_item_sales_amount) as net_item_sales_amount,\n        count_if( is_return = true ) as return_count\n    from order_item\n    group by\n        1\n),\nfinal as (\n\n    select \n\n        orders.order_key, \n        orders.order_date,\n        orders.customer_key,\n        orders.status_code,\n        orders.priority_code,\n        orders.clerk_name,\n        orders.ship_priority,     \n        1 as order_count,\n        order_item_summary.return_count,             \n        order_item_summary.gross_item_sales_amount,\n        order_item_summary.item_discount_amount,\n        order_item_summary.item_tax_amount,\n        order_item_summary.net_item_sales_amount\n    from\n        orders\n        inner join order_item_summary\n            on orders.order_key = order_item_summary.order_key\n)\nselect \n    *\nfrom\n    final\n\norder by\n    order_date", "relation_name": "flybuysdb.dbt_lbondkennedy.fct_orders", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:30.218801Z", "completed_at": "2026-02-10T22:57:30.221242Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:30.221601Z", "completed_at": "2026-02-10T22:57:32.098767Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 1.8807125091552734, "adapter_response": {"_message": "SUCCESS 60175", "code": "SUCCESS", "rows_affected": 60175, "query_id": "01c25421-080a-d1f4-0004-7d832e280416", "rows_inserted": 60175, "rows_deleted": 0, "rows_updated": 0, "rows_duplicates": 0}, "message": "SUCCESS 60175", "failures": null, "unique_id": "model.analytics.fct_order_items", "compiled": true, "compiled_code": "\n\nwith order_item as (\n    \n    select * from flybuysdb.dbt_lbondkennedy.order_items\n\n),\npart_supplier as (\n    \n    select * from flybuysdb.dbt_lbondkennedy.part_suppliers\n\n),\nfinal as (\n    select \n        order_item.order_item_key,\n        order_item.order_key,\n        order_item.order_date,\n        order_item.customer_key,\n        order_item.part_key,\n        order_item.supplier_key,\n        order_item.order_item_status_code,\n        order_item.is_return,\n        order_item.line_number,\n        order_item.ship_date,\n        order_item.commit_date,\n        order_item.receipt_date,\n        order_item.ship_mode,\n        part_supplier.cost as supplier_cost,\n        \n        order_item.base_price,\n        order_item.discount_percentage,\n        order_item.discounted_price,\n        order_item.tax_rate,\n        part_supplier.nation_key,\n        1 as order_item_count,\n        order_item.quantity,\n        order_item.gross_item_sales_amount,\n        order_item.discounted_item_sales_amount,\n        order_item.item_discount_amount,\n        order_item.item_tax_amount,\n        order_item.net_item_sales_amount\n\n    from\n        order_item\n        inner join part_supplier\n            on order_item.part_key = part_supplier.part_key and\n                order_item.supplier_key = part_supplier.supplier_key\n\n)\nselect \n    *\nfrom\n    final\norder by\n    order_date", "relation_name": "flybuysdb.dbt_lbondkennedy.fct_order_items", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:29.601089Z", "completed_at": "2026-02-10T22:57:29.605279Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:29.605732Z", "completed_at": "2026-02-10T22:57:32.206787Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.6065893173217773, "adapter_response": {"_message": "SUCCESS 1500", "code": "SUCCESS", "rows_affected": 1500, "query_id": "01c25421-080a-dc9d-0004-7d832e27d6a6", "rows_inserted": 1500, "rows_deleted": 0, "rows_updated": 0, "rows_duplicates": 0}, "message": "SUCCESS 1500", "failures": null, "unique_id": "model.analytics.dim_customers.v2", "compiled": true, "compiled_code": "\n\nwith customer as (\n\n    select * from flybuysdb.dbt_lbondkennedy.stg_tpch_customers\n\n),\nnation as (\n\n    select * from flybuysdb.dbt_lbondkennedy.stg_tpch_nations\n),\nregion as (\n\n    select * from flybuysdb.dbt_lbondkennedy.stg_tpch_regions\n\n),\ncustomer_flags as (\n    select * from flybuysdb.dbt_lbondkennedy.customer_flags\n),\n\nfinal as (\n    select \n        customer.customer_key,\n        customer.name,\n        customer.address,\n        --- Break the contract \n        -- nation.nation_key as nation_key, \n        nation.name as nation,\n        --- Break the contract again\n        -- region.region_key as region_key,\n        region.name as region,\n        customer.phone_number,\n        customer.account_balance,\n        customer.market_segment,\n        customer_flags.lifetime_value,\n        customer_flags.is_high_value,\n        customer_flags.is_mid_value,\n        customer_flags.is_low_value\n    from\n        customer\n        inner join nation\n            on customer.nation_key = nation.nation_key\n        inner join region\n            on nation.region_key = region.region_key\n        left join customer_flags\n            on customer.customer_key = customer_flags.customer_key\n)\nselect \n    *\nfrom\n    final\norder by\n    customer_key", "relation_name": "flybuysdb.dbt_lbondkennedy.dim_customers_v2", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:28.471171Z", "completed_at": "2026-02-10T22:57:28.480736Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:28.482806Z", "completed_at": "2026-02-10T22:57:32.296874Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 3.8264319896698, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01c25421-080a-d88a-0004-7d832e281072"}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.analytics.inc_orders", "compiled": true, "compiled_code": "\n\nselect * from flybuysdb.dbt_lbondkennedy.raw_orders\n\n\n    -- this filter will only be applied on an incremental run\n    where modified_at > (select max(modified_at) from flybuysdb.dbt_lbondkennedy.inc_orders) \n", "relation_name": "flybuysdb.dbt_lbondkennedy.inc_orders", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:32.112607Z", "completed_at": "2026-02-10T22:57:32.122953Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:32.125426Z", "completed_at": "2026-02-10T22:57:32.507144Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4000124931335449, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25421-080a-d978-0004-7d832e27a84a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.analytics.agg_ship_modes_hardcoded_pivot", "compiled": true, "compiled_code": "/* Create a pivot table with hard-coded columns based on a query of the ship modes that are in the system */\n\nwith merged as (\n    select\n        date_part('year', order_date) as order_year,\n        ship_mode,\n        gross_item_sales_amount\n    from flybuysdb.dbt_lbondkennedy.fct_order_items\n)\n\nselect\n    * \nfrom\n    merged\n    -- have to manually map strings in the pivot operation\n    pivot(sum(gross_item_sales_amount) for ship_mode in (\n        'AIR',\n        'REG AIR',\n        'FOB',\n        'RAIL',\n        'MAIL',\n        'SHIP',\n        'TRUCK'\n    )) as p \n\norder by order_year", "relation_name": "flybuysdb.dbt_lbondkennedy.agg_ship_modes_hardcoded_pivot", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:32.108811Z", "completed_at": "2026-02-10T22:57:32.117583Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:32.120765Z", "completed_at": "2026-02-10T22:57:32.503050Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.3989732265472412, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25421-080a-dc9d-0004-7d832e27d6ae"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.analytics.agg_returned_orders_by_month", "compiled": true, "compiled_code": "with fct_order_items as (\n    select * from flybuysdb.dbt_lbondkennedy.fct_order_items\n),\n\nfinal as (\n    select\n        date_trunc(MONTH, fct_order_items.order_date) as order_month \n        , count(case when is_return then order_item_key else null end) as returned_orders\n        , 1.0* returned_orders / nullif (\n            count(order_item_key)\n            , 0\n        ) as return_rate\n        , count(*) as row_count\n    from fct_order_items\n    group by 1\n    order by 1 desc\n)\n\nselect * from final", "relation_name": "flybuysdb.dbt_lbondkennedy.agg_returned_orders_by_month", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:32.118140Z", "completed_at": "2026-02-10T22:57:32.127712Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:32.131227Z", "completed_at": "2026-02-10T22:57:32.511613Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.40346622467041016, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25421-080a-d781-0004-7d832e27b6ea"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.analytics.use_variables", "compiled": true, "compiled_code": "-- This is here to show that data older than start_date exists - run this first\n-- select min(order_date) from flybuysdb.dbt_lbondkennedy.fct_order_items\n\n-- start_date is defined in the dbt_project.yml \n-- to illustrate overriding variables from the command line, run dbt run -m use_variables --vars '{\"start_date\": \"1996-01-01\"}'\nselect * from flybuysdb.dbt_lbondkennedy.fct_order_items where order_date >= '1999-01-01'", "relation_name": "flybuysdb.dbt_lbondkennedy.use_variables", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T22:57:32.115977Z", "completed_at": "2026-02-10T22:57:32.120330Z"}, {"name": "execute", "started_at": "2026-02-10T22:57:32.123560Z", "completed_at": "2026-02-10T22:57:32.573220Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.46566152572631836, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25421-080a-dc99-0004-7d832e276f02"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.analytics.monthly_gross_revenue", "compiled": true, "compiled_code": "select \n    date_trunc(MONTH, fct_order_items.order_date) as order_month\n    , sum(fct_order_items.gross_item_sales_amount) as gross_revenue\nfrom flybuysdb.dbt_lbondkennedy.fct_order_items\ngroup by 1", "relation_name": "flybuysdb.dbt_lbondkennedy.monthly_gross_revenue", "batch_results": null}], "elapsed_time": 10.931969165802002, "args": {"log_level_file": "debug", "log_format": "json", "profiles_dir": "./", "send_anonymous_usage_stats": true, "use_experimental_skip_nodes_synchronously": false, "require_yaml_configuration_for_mf_time_spines": false, "strict_mode": false, "target_path": "target", "use_colors": true, "require_ref_searches_node_package_before_root": false, "log_level": "debug", "vars": {}, "static_parser": true, "project_dir": "/app/dbt_project/8525c8f9-11f4-41de-8b75-f0a9b14e9a47", "require_unique_project_resource_names": false, "vortex_event_forwarding_enabled": false, "require_generic_test_arguments_property": true, "partial_parse_file_diff": true, "log_path": "logs", "require_all_warnings_handled_by_warn_error": false, "partial_parse": true, "version_check": true, "exclude": [], "select": [], "introspect": true, "favor_state": false, "print": true, "validate_macro_args": false, "printer_width": 80, "populate_cache": true, "state_modified_compare_more_unrendered_values": false, "show_resource_report": false, "skip_nodes_if_on_run_start_fails": false, "use_experimental_job_health_monitor": false, "use_colors_file": true, "require_batched_execution_for_custom_microbatch_strategy": false, "require_valid_schema_from_generate_schema_name": false, "macro_debugging": false, "skip_semantic_layer": false, "show_all_deprecations": false, "defer": false, "log_file_max_bytes": 0, "use_fast_test_edges": false, "empty": false, "source_freshness_run_project_hooks": true, "log_format_file": "json", "upload_to_artifacts_ingest_api": false, "which": "run", "indirect_selection": "eager", "warn_error_options": {"error": [], "warn": [], "silence": []}, "state_modified_compare_vars": false, "quiet": false, "profile": "user", "require_nested_cumulative_type_params": false, "cache_selected_only": false, "invocation_command": "dbt ", "require_resource_names_without_spaces": true, "write_json": true, "require_explicit_package_overrides_for_builtin_materializations": true, "skip_write_msgpack_if_exist": false}}